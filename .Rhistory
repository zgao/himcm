install.packages('mixtools')
library(mixtools)
install.packages('datasets')
data(faithful)
attach(faithful)
waiting
data <- c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4)
normalmixEM(data,lambda=.5,mu=c(1,3),sigma=1)
wait.data <- normalmixEM(data,lambda=.5,mu=c(1,3),sigma=1)
plot(wait.data)
plot(wait.data)
plot(wait.data, density=TRUE)
data <- log(data)
wait.data <- normalmixEM(data,lambda=.5,mu=c(0,log(3)),sigma=1)
plot(wait.data, density=TRUE)
log(1)
log(10)
normalmixEM(data,lambda=.5,mu=c(0,log(3)),sigma=1)
e^
e^2
E^2
exp(2)
exp(1.048607454)
exp(-0.4)
mu1 <- 0.003414787
mu2 <- 1.048607454
sigma1 <- 0.2093175
sigma2 <- 0.2093175
c1 <- 0.251235
c2 <- 0.748765
mix <- function(x) {
return (c1*dnorm(log(x),mean=mu1,sd=sigma1)+c2*dnorm(log(x),mean=mu2,sd=sigma2));
}
qplot(mix)
library(ggplot2)
install.packages('ggplot2')
install.packages('digest'0
install.packages('digest')
install.packages('ggplot2')
install.packages('gtable')
install.packages('ggplot2')
install.packages()
install.packages('plyr')
install.packages('ggplot2')
install.packages('proto')
install.packages('ggplot2')
install.packages('ggplot2', dependencies=TRUE)
library(ggplot2)
dat <- seq(from=0.1, to=4.0, by=0.01)
fdat <- mix(dat)
plot(dat~fdat)
plot(fdat~dat)
dat <- seq(from=0.1, to=6.0, by=0.01)
fdat <- mix(dat)
plot(fdat~dat)
mean(fdat)
mean(fdat)*5.9
plot((fdat/(mean(fdat)*5.9))~dat)
mean(fdat/(mean(fdat)*5.9))
mean(fdat/(mean(fdat)*5.9))*5.9
plot((fdat/(mean(fdat)*5.9*5.9))~dat)
plot((fdat/(mean(fdat)*5.9))~dat)
[20,] 4.102027e-10 1.000000e+00
dat1 <- seq(from=0.5,to=1.5,by=0.001)
fdat1 <- mix(dat1)
sum(fdat1)
sum(fdat1) / (1001)
dat2 <- seq(from=1.5,to=2.5,by=0.001)
fdat2 <- mix(dat2)
sum(fdat2) / (1001)
dat2 <- seq(from=2.5,to=3.5,by=0.001)
fdat2 <- mix(dat2)
sum(fdat2) / (1001)
dat <- seq(from=0.1,to=6.0,by=0.001)
plot(mix(dat)~dat)
> mix <- function(x) {
+ return (c1*dnorm(log(x),mean=mu1,sd=sigma1)+c2*dnorm(log(x),mean=mu2,sd=sigma2));
+ }
plot(dnorm(log(dat),mean=1.0,sd=0.2)~dat)
sum(dnorm(log(dat),mean=1.0,sd=0.2))
sum(dnorm(log(dat),mean=1.0,sd=0.2))/5900
sum(dnorm(log(dat),mean=1.0,sd=0.2))/1000
dat <- seq(from=-5.0,to=5.0,by=0.001)
plot(dnorm(dat))
plot(dnorm(dat)~dat)
dat <- seq(from=0.1,to=6.0,by=0.001)
sum(dlnorm(dat,meanlog=1.0,sd=0.2,log=FALSE))
sum(dlnorm(dat,meanlog=mu1,sdlog=sigma1,log=FALSE))
plot((c1*dlnorm(dat,meanlog=mu1,sdlog=sigma1,log=FALSE)+c2*dlnorm(dat,meanlog=mu2,sdlog=sigma2,log=FALSE))~dat)
mix <- function(x) {
return (c1*dlnorm(dat,meanlog=mu1,sdlog=sigma1,log=FALSE)+c2*dlnorm(dat,meanlog=mu2,sdlog=sigma2,log=FALSE));
}
sum(mix(seq(from=0.5,to=1.5,by=0.001)))
plot(mix(dat)~dat)
sum(mix(seq(from=0.5,to=6.0,by=0.001)))
sum(mix(seq(from=0.5,to=1.5,by=0.001)))
sum(mix(seq(from=0.5,to=0.6,by=0.001)))
dat1 <- seq(from=0.5,to=1.5,by=0.001)
dat1
mix <- function(x) {
return (c1*dlnorm(x,meanlog=mu1,sdlog=sigma1,log=FALSE)+c2*dlnorm(x,meanlog=mu2,sdlog=sigma2,log=FALSE));
}
sum(mix(seq(from=0.5,to=1.5,by=0.001)))
sum(mix(seq(from=1.5,to=2.5,by=0.001)))
sum(mix(seq(from=2.5,to=3.5,by=0.001)))
sum(mix(seq(from=3.5,to=4.5,by=0.001)))
data <- c(0,0,1,1,1,2,2,3,3,3,3,3,3,3,4,4,4,4,4,5)
gamma.mix <- gammamixEM(data)
gamma.mix <- gammamixEM(data, epsilon=1e-08)
data <- c(0.25,0.25,1,1,1,2,2,3,3,3,3,3,3,3,4,4,4,4,4,5)
gamma.mix <- gammamixEM(data, epsilon=1e-08)
g.mix <- function(x) {
  return gamma.mix$lambda[1]*dgamma(x, gamma.mix$gamma.pars[1], 1/gamma.mix$gamma.pars[2]) + gamma.mix$lambda[2]*dgamma(x, gamma.mix$gamma.pars[3], 1/gamma.mix$gamma.pars[4]);
}
gamma.mix$lambda[1]
g.mix <- function(x) {
return (gamma.mix$lambda[1]*dgamma(x, gamma.mix$gamma.pars[1], 1/gamma.mix$gamma.pars[2]) + gamma.mix$lambda[2]*dgamma(x, gamma.mix$gamma.pars[3], 1/gamma.mix$gamma.pars[4]));
}
test <- seq(from=0.0,to=6.0,step=0.01)
test <- seq(from=0.0,to=6.0,by=0.01)
plot(g.mix(test)~test)
hist(data,col="pink",add=T,freq=F,breaks=5)
plot(g.mix(test)~test)
hist(data,col="pink",add=T,freq=F,breaks=c(0.5,1.5,2.5,3.5,4.5,5.5))
hist(data,col="pink",add=T,freq=F,breaks=c(0.5,1.5,2.5,3.5,4.5))
data
hist(data,col="pink",add=T,freq=F,breaks=c(0.0,0.5,1.5,2.5,3.5,4.5,5.5))
sofar <- c()
for (i in 1:10000)
dim(sofar)
sofar <- c(1)
dim(sofar)
sofar
len(sofar)
length(sofar)
sofar[length(sofar)]
sofar[length(sofar)][1]
sofar[length(sofar)]
1
sofar <- 0
sofar <- c()
for (i in 1:1000000)
{
poisson <- -log(runif(1))
sofar <- c(0)
for (i in 1:1000000)
{
poisson <- -log(runif(1))
last <- sofar[length(sofar)]
next <- last+poisson
sofar <- c(sofar,next)
}
next <- 1
next
sofar <- c(0)
for (i in 1:1000000)
{
poisson <- -log(runif(1))
last <- sofar[length(sofar)]
nxt <- last+poisson
sofar <- c(sofar,nxt)
}
sofar
filtered.sofar <- c()
for (i in 1:length(sofar))
if (0.5*(sin(sofar[i])+1) > runif(1))
filtered.sofar <- c(filtered.sofar, sofar[i])
filtered.sofar
diff <- c()
for (i in 1:length(filtered.sofar)-1)
diff <- c(diff, filtered.sofar[i + 1] - filtered.sofar[i])
diff
hist(diff)
hist(diff,breaks=50)
hist(diff,breaks=100)
hist(diff,breaks=100)
hist(diff,breaks=1000)
g.mix <- function(x) {
  return gamma.mix$lambda[1]*dgamma(x, gamma.mix$gamma.pars[1], 1/gamma.mix$gamma.pars[2]) + gamma.mix$lambda[2]*dgamma(x, gamma.mix$gamma.pars[3], 1/gamma.mix$gamma.pars[4]);
g.mix <- function(x) {
  return (gamma.mix$lambda[1]*dgamma(x, gamma.mix$gamma.pars[1], 1/gamma.mix$gamma.pars[2]) + gamma.mix$lambda[2]*dgamma(x, gamma.mix$gamma.pars[3], 1/gamma.mix$gamma.pars[4]));
}
plot(g.mix(test)~test)
hist(data,col="pink",add=T,freq=F,breaks=c(0.0,0.5,1.5,2.5,3.5,4.5,5.5))
print(gamma.mix)
mix <- function(x) {
return (c1*dlnorm(x,meanlog=mu1,sdlog=sigma1,log=FALSE)+c2*dlnorm(x,meanlog=mu2,sdlog=sigma2,log=FALSE));
}
mix
mix(2.5)
datf <- seq(from=0.01, to=5.00, by=0.01)
plot(mix(datf)~datf)
mean(mix(datf))
mean(mix(datf)*datf)
sum <- 0.0
for (i in 1:500)
sum <- sum + (mix(i / 100) * i / 100)
sun
sum
sum / 500
sum / 100
mean <- sum/100
sum <- 0
for (i in 1:500)
sum <- sum + (mix(i / 100) * i * i / 10000)
sum
sum / 100
variance <- sum / 100 - mean ** 2
variance
c1 * sigma1 ** 2 + c2 * sigma2 ** 2 + c1 * c2 * (mu1 - mu2) ** 2
c1 * sigma1 + c2 * sigma2 + c1 * c2 * (mu1 - mu2) ** 2
sigma1
sigma1 * .24
sigma2
c1
c2
sigma1
sigma2
mix
mu1
mu2
g.mix <- function(x) {
plot(g.mix)
plot(g.mix,xlim=c(0.01,5.00))
plot(g.mix,xlim=c(0.01,6.00))
plot(g.mix,xlim=c(0.001,7.00))
par(new=TRUE)
plot(g.mix,xlim=c(0.001,7.00))
hist(c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4),add=TRUE)
plot(g.mix,xlim=c(0.001,7.00))
plot(mix,xlim=c(0.001,5.00))
hist(c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4),add=TRUE,freq=FALSE)
plot(mix,xlim=c(0.001,5.00))
hist(c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4),add=TRUE,freq=FALSE,breaks=c(0.0,1.5,2.5,3.5,4.5))
plot(mix,xlim=c(0.001,5.00))
hist(c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4),add=TRUE,freq=FALSE,breaks=c(0.5,1.5,2.5,3.5,4.5))
quit()
plot(mix,xlim=c(0.001,5.00),main='Service time: fit vs. given')
plot(mix,xlim=c(0.001,5.00),main='Service time: fit vs. given',ylab='Density')
plot(mix,xlim=c(0.001,5.00),main='Service time: fit vs. given',xlab='Service time (min.)',ylab='Density')
hist(c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4),add=TRUE,freq=FALSE,breaks=c(0.5,1.5,2.5,3.5,4.5))
hist(c(1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4),main='Service time distribution',xlab='Service time (min.)',freq=FALSE,breaks=c(0.5,1.5,2.5,3.5,4.5))
quit()
